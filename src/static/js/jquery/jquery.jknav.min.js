/*
 jknav
 @name      jquery.jknav.js
 @author    Yu-Jie Lin http://lmgtfy.com/?q=livibetter
 @version   0.3.1
 @date      09-20-2010
 @copyright (c) 2010 Yu-Jie Lin <livibetter@gmail.com>
 @license   BSD License
 @homepage  http://lilbtn.blogspot.com/2010/05/js-jquery-jknav-jk-binding-navigation.html
 @example   http://lilbtn.googlecode.com/hg/src/static/js/jquery/jquery.jknav.demo.html
*/
(function(a){function h(d,b){var c=a.jknav.index[b.name];if(c==null){var f=a(a.jknav.TARGET).scrollTop();a.each(a.jknav.items[b.name],function(e,g){var i=Math.floor(a(g).offset().top);if(f>=i)c=e});if(c==null)c=d>0?0:a.jknav.items[b.name].length-1;else if(d>0&&++c>=a.jknav.items[b.name].length)c=0;else if(d<0&&f==Math.floor(a(a.jknav.items[b.name][c]).offset().top)&&--c<0)c=a.jknav.items[b.name].length-1}else{if(!b.circular&&(c==0&&d==-1||c==a.jknav.items[b.name].length-1&&d==1))return c;c+=d;if(c>=
a.jknav.items[b.name].length)c=0;if(c<0)c=a.jknav.items[b.name].length-1}return a.jknav.index[b.name]=c}function j(d,b){if(d.target.tagName.toLowerCase()==a.jknav.TARGET_KEYUP){var c=String.fromCharCode(d.keyCode).toLowerCase();if(c==b.up.toLowerCase()||c==b.down.toLowerCase()){if(b.reevaluate)a.jknav.index[b.name]=null;var f=h(c==b.down.toLowerCase()?1:-1,b);c=a(a.jknav.items[b.name][f][0]);a(a.jknav.TARGET).animate({scrollLeft:Math.floor(c.offset().left),scrollTop:Math.floor(c.offset().top)},b.speed,
b.easing,function(){var e=a.jknav.items[b.name][f][1];e&&e(a.jknav.items[b.name][f][0])})}}}a.fn.jknav=function(d,b){if(b==null)b="default";if(a.jknav.items[b]==null)a.jknav.items[b]=[];return this.each(function(){a.jknav.items[b].push([this,d]);a.jknav.items[b].sort(function(c,f){var e=a(c[0]).offset().top,g=a(f[0]).offset().top;if(e<g)return-1;if(e>g)return 1;if(e==g){e=a(c[0]).offset().left;g=a(f[0]).offset().left;if(e<g)return-1;if(e>g)return 1;return 0}})})};a.jknav={index:{},items:{},default_options:{up:"k",
down:"j",name:"default",easing:"swing",speed:"normal",circular:true,reevaluate:false},TARGET_KEYUP:a.browser.mozilla?"html":"body",TARGET:a.browser.mozilla||a.browser.msie?"html":"body",init:function(d){var b=a.extend(a.extend({},a.jknav.default_options),d);a.jknav.index[b.name]=null;a(a.jknav.TARGET_KEYUP).keyup(function(c){j(c,b)})}}})(jQuery);
